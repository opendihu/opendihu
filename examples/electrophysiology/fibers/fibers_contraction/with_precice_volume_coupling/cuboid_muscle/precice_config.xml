<?xml version="1.0" encoding="UTF-8" ?>
<precice-configuration>
  <log>
    <sink
      filter="%Severity% > debug"
      format="---[precice] %ColorizedSeverity% %Message%"
      enabled="true" />
  </log>

  <data:scalar name="Gamma" />
  <data:vector name="Geometry"/>

  <mesh name="MuscleMesh" dimensions="3">
      <use-data name="Geometry"/>
      <use-data name="Gamma"/>
  </mesh>

  <mesh name="FibersMesh" dimensions="3">
    <use-data name="Geometry"/>
    <use-data name="Gamma"/>
  </mesh>

  <participant name="Fibers">
    <provide-mesh name="FibersMesh"/>
    <receive-mesh name="MuscleMesh" from="Muscle"/>

    <read-data name="Geometry" mesh="FibersMesh"/>
    <write-data name="Gamma" mesh="FibersMesh"/>

    <mapping:rbf direction="read" from="MuscleMesh" to="FibersMesh" constraint="consistent">
      <basis-function:compact-polynomial-c6 support-radius="0.5"/>
    </mapping:rbf>

    <export:vtu directory="../output/precice-output" every-n-time-windows="1"/>
  </participant>

  <participant name="Muscle">
    <provide-mesh name="MuscleMesh"/>
    <receive-mesh name="FibersMesh" from="Fibers"/>

    <read-data name="Gamma" mesh="MuscleMesh"/>
    <write-data name="Geometry" mesh="MuscleMesh"/>

    <mapping:rbf direction="read" from="FibersMesh" to="MuscleMesh" constraint="consistent">
      <basis-function:compact-polynomial-c6 support-radius="0.5"/>
    </mapping:rbf>
    <export:vtu directory="../output/precice-output" every-n-time-windows="1"/>
  </participant>

  <m2n:sockets acceptor="Fibers" connector="Muscle"/>

  <coupling-scheme:serial-explicit>
    <participants first="Fibers" second="Muscle" />
    <time-window-size value="1e-1" />
    <max-time value="30.0" />
    <exchange data="Geometry" mesh="MuscleMesh" from="Muscle" to="Fibers"/>
    <exchange data="Gamma" mesh="FibersMesh" from="Fibers" to="Muscle"/>
  </coupling-scheme:serial-explicit>
</precice-configuration>